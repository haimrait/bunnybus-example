# `superagent-wrapper`

<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

- [`ProxyAgent`](#proxyagent)
  - [Constructor](#constructor)
    - [`new ProxyAgent(options)`](#new-proxyagentoptions)
  - [Getters and Setters](#getters-and-setters)
    - [`resolutionMiddleware(func)`](#resolutionmiddlewarefunc)
    - [`rejectionMiddleware(func)`](#rejectionmiddlewarefunc)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

## `ProxyAgent`
This is a proxy command class around `SuperAgent.agent()`.

### Constructor
#### `new ProxyAgent(options)`
Creates a new `SuperAgent.agent()` which allows for setting of defaults.

```javascript
const SuperAgent = require('superagent-wrapper');

const agent = new SuperAgent.ProxyAgent();

await response = agent.get('localhost:3000/');
```

* `options.superAgentOptions` - Any options that can be passed to [`agent()`](https://github.com/node-modules/agentkeepalive#new-agentoptions) instantiation.
* `options.host` - Address for the service.  Eg (`localhost`, `localhost:3000`, `127.0.0.1`, `http://www.google.com`, `https://www.google.com`).
* `options.prefix` - Any part of the url that should be prefixed as part of the default.  Eg (`/api`, `/api/v4`).
* `options.retry` - Amount of request attempts to try if response code are not of `200`, `401`, `404`, `422`.
* `options.timeoutResponseMs` - Time in units of milliseconds to consider a request to be in a timed out state.  This time is measured between the starting call of the request to the initial server response.
* `options.timeoutDeadlineMs` - Time in units of milliseconds to consider a request to be in a timed out state.  This time is measured between the starting call of the request to when the response is completed served and connection is closed.
* `options.*` - All other properties that are not recognized will be proxied through.

### Getters and Setters

#### `resolutionMiddleware(func)`
Sets a middleware to allow for inspection of the Http response.

* `func` - A function with 2 parameters.  First parameter is the Http response and the seconds parameter is the promsie callback for `resolve`.

```javascript
const SuperAgent = require('superagent-wrapper');

const agent = new SuperAgent.ProxyAgent();

agent.resolutionMiddleware = (response, resolve) => {
    // do something with the response

    resolve(response);
};
```

#### `rejectionMiddleware(func)`
Sets a middleware to allow for inspection of an error from a Http response.

* `func` - A function with 2 parameters.  First parameter is the error object and the seconds parameter is the promsie callback for `reject`.

```javascript
const SuperAgent = require('superagent-wrapper');

const agent = new SuperAgent.ProxyAgent();

agent.rejectionMiddleware = (error, reject) => {
    // do something with the error

    reject(error);
};